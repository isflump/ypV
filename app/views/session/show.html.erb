<% content_for :title, "Session" %>
<div class="tonberry"></div>


<div class="exec_time_full_screen_grey_layer" id='exec_time_full_screen_grey_layer'>
  <div class='full_calendar_close_btn' onclick="close_full_calendar()"><i class="fa fa-times-circle-o"></i></div>
    <div id='full_calendar' class="full_calendar"></div>

  <div class="full_calendar_execution_info" id="full_calendar_execution_info">
    <img  class='full_calendar_execution_info_device' id="full_calendar_execution_info_detail_text1"></img>
    <div class="full_calendar_execution_info_detail_block">
      <div class="full_calendar_execution_info_detail_text" id="full_calendar_execution_info_detail_text2"></div>
      <div class="full_calendar_execution_info_detail_text" id="full_calendar_execution_info_detail_text3"></div>
      <div class="full_calendar_execution_info_detail_text" id="full_calendar_execution_info_detail_text4"></div>
      <div class="full_calendar_execution_info_detail_text" id="full_calendar_execution_info_detail_text5"></div>
    </div>
  </div>
</div>

<div class="main_container" >

  <%= render "shared/side_menu" %>

  <div class="detail_header_container">
    <div class="detail_header_text_block">
        <div class="project_name_block"><i class="fa fa-rocket" style="font-size:22.5px;margin-right:5px;color:#55DAE1"></i> <%=@session.project.name%></div>
        <div class="project_execution_time_block"><i class="fa fa-clock-o" color="#01AEF2"></i> <%=parse_date(@session.start_time)%></div>
    </div>
    <div class="detail_header_info_block">
        <% if @session.browser =~ /chrome/i %>
          <img src='/assets/chrome-icon.png' class='detail_execution_device'></img>
        <% elsif @session.browser =~ /(firefox|firefox_no_js)/i%>
          <img src='/assets/firefox-icon.png' class='detail_execution_device'></img>
        <% elsif @session.browser =~ /ie/i%>
          <img src='/assets/ie-icon.png' class='detail_execution_device'></img>
        <% elsif @session.browser =~ /android/i%>
          <img src='/assets/Android.png' class='detail_execution_device'></img>
        <% end %>
      <div class="detail_execution_env_info">
          <div class="detail_execution_text_box">Selenuim: v<%=@session.selenium_version%></div>
          <div class="detail_execution_text_box">Tlib: v<%=@session.tlib_version%></div>
      </div>
    </div>
  </div>

  <div class='info_container' onmouseover='dismiss_detail_exec_time()'>
    <div id="sessionGraph" class="report_graph_container">
        <canvas id="sessionStatusChart" height="255px" width="350px" onclick="filterBySessionStatus(event)"></canvas>
        <canvas id="sessionFolderChart" height="255px" width="550px" onclick="filterBySessionLocation(event,true,'NONE')"></canvas>
        <div id="sessionStatusLegend" style="width:850px"></div>
    </div>

    <div class="home_report_list_container">
      <!--==============================================================================================-->
      <div id="session_table_tag_view" class="session_table_tag_view" >
          <div id="session_status_tag_view" style="display:inline-block;"></div>
          <div id="session_path_tag" class="path_tag_container"></div>
      </div>
      <!--==============================================================================================-->
      <table id="sessionTable" class="display" cellspacing="0" width="100%">
          <thead>
              <tr>
                <th>Case Name</th>
                <th>Method Name</th>
                <th>Duration(sec)</th>
                <th>Spira ID</th>
                <th>Status</th>
                <!--th>Location</th-->
              </tr>
          </thead>
          <tbody id="sessionTableBody">
            <% @executions.each do |exec| %>
              <tr id="ses_<%=exec.id%>" rel="tooltip" title="Double click to see execution detail" style="cursor:pointer" onclick="highlight_session_row(this.id)" ondblclick="window.open('/execution/<%=exec.id%>','_blank')">
                  <td><%=exec.case_id%></td>
                  <td rel="tooltip" title="<%=exec.location%>"><%=exec.case_name%></td>
                  <td><%=exec.duration.round()%></td>
                  <td><%= exec.spira_case_id.empty? ? "N/A" : exec.spira_case_id %></td>
                  <% if exec.result =~/passed/i %>
                    <td style="color:rgba(70, 191, 189,0.5)"><%=exec.result.capitalize %></td>
                  <%else%>
                    <td style="color:rgba(247, 70, 74,0.9)"><%=exec.result.capitalize %></td>
                  <%end%>
                  <!--td style="text-align:center" rel="tooltip" title="<%=exec.location%>"><i class="fa fa-folder-o"></i></td-->
              </tr>
            <%end%>
          </tbody>
        </table>
    </div>
  </div>
